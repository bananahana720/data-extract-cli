STORY 5-7 TEST SKELETON FILE STRUCTURE
======================================

tests/
├── behavioral/
│   └── epic_5/
│       ├── __init__.py (NEW)
│       ├── conftest.py (NEW) - Shared fixtures for Epic 5
│       │   ├── pytest_configure()
│       │   ├── incremental_state_file
│       │   ├── processed_corpus_with_state
│       │   ├── orphan_corpus
│       │   └── mixed_corpus
│       │
│       └── test_incremental_behavior.py (NEW) - 10 tests
│           ├── TestChangeDetectionBehavior (5 tests)
│           │   ├── test_unchanged_files_not_reprocessed
│           │   ├── test_modified_files_detected_by_hash
│           │   ├── test_new_files_detected_not_in_state
│           │   ├── test_deleted_files_detected_as_orphans
│           │   └── test_config_change_detected_and_invalidates_cache
│           │
│           ├── TestStateFilePersistence (3 tests)
│           │   ├── test_state_file_persists_across_sessions
│           │   ├── test_state_file_atomic_writes
│           │   └── test_state_file_schema_validation
│           │
│           └── TestIncrementalModeIntegration (2 tests)
│               ├── test_incremental_flag_activates_change_detection
│               └── test_force_flag_bypasses_incremental_skip
│
├── unit/
│   └── test_cli/
│       └── test_incremental_processor.py (NEW) - 17 tests
│           ├── TestFileHasher (4 tests)
│           │   ├── test_sha256_hash_deterministic
│           │   ├── test_different_content_produces_different_hash
│           │   ├── test_large_file_hash_calculation
│           │   └── test_binary_file_hash
│           │
│           ├── TestStateFile (4 tests)
│           │   ├── test_state_file_schema_valid
│           │   ├── test_state_file_read_write
│           │   ├── test_state_file_atomic_writes
│           │   └── test_state_file_corruption_handling
│           │
│           ├── TestChangeDetector (5 tests)
│           │   ├── test_detects_new_files
│           │   ├── test_detects_modified_files
│           │   ├── test_detects_unchanged_files
│           │   ├── test_detects_deleted_files
│           │   └── test_change_summary_totals
│           │
│           └── TestGlobPatternExpansion (4 tests)
│               ├── test_simple_extension_pattern
│               ├── test_recursive_pattern
│               ├── test_pattern_no_matches_error
│               └── test_multiple_patterns_union
│
├── integration/
│   └── test_cli/
│       └── test_batch_incremental.py (NEW) - 12 tests
│           ├── TestProcessIncrementalFlag (4 tests)
│           │   ├── test_incremental_flag_accepted_by_process_command
│           │   ├── test_incremental_mode_creates_state_file
│           │   ├── test_incremental_skips_unchanged_files
│           │   └── test_incremental_processes_new_files_only
│           │
│           ├── TestProcessForceFlag (2 tests)
│           │   ├── test_force_flag_reprocesses_all_files
│           │   └── test_force_flag_updates_state_with_new_timestamps
│           │
│           ├── TestStatusCommand (4 tests)
│           │   ├── test_status_command_displays_panel
│           │   ├── test_status_shows_processed_file_count
│           │   ├── test_status_shows_sync_state
│           │   └── test_status_offers_cleanup_option_for_orphans
│           │
│           └── TestGlobPatternCLI (2 tests)
│               ├── test_process_accepts_glob_pattern_argument
│               └── test_glob_pattern_displays_match_count
│
├── uat/
│   └── journeys/
│       └── test_journey_7_incremental_batch.py (NEW) - 10 tests
│           ├── TestJourney7IncrementalBatch (7 tests)
│           │   ├── test_change_detection_panel_displays
│           │   ├── test_incremental_processes_only_changes
│           │   ├── test_time_savings_displayed
│           │   ├── test_force_flag_reprocesses_all
│           │   ├── test_status_command_shows_sync_state
│           │   ├── test_orphan_detection_and_cleanup
│           │   └── test_glob_pattern_support
│           │
│           └── TestJourney7Assertions (3 tests)
│               ├── test_change_panel_assertion
│               ├── test_time_savings_assertion
│               └── test_orphan_cleanup_assertion
│
└── performance/
    └── test_incremental_performance.py (NEW) - 3 tests
        └── TestIncrementalPerformance (3 tests)
            ├── test_state_check_startup_under_2_seconds
            ├── test_hash_calculation_reasonable_for_large_files
            └── test_state_file_load_under_100ms


SUMMARY STATISTICS
==================

Files Created:    6
Total Test Count: 52 tests
Test Classes:     15 classes

By Layer:
  Behavioral Tests:   10 tests (4 classes)
  Unit Tests:         17 tests (4 classes)
  Integration Tests:  12 tests (4 classes)
  UAT Tests:          10 tests (2 classes)
  Performance Tests:   3 tests (1 class)

By Feature Coverage:
  Change Detection:     15 tests
  State Management:      8 tests
  CLI Integration:      14 tests
  User Workflows:       10 tests
  Performance:           3 tests
  Fixtures/Helpers:      2 tests


TEST MARKERS USAGE
==================

All tests use pytest markers for selective execution:

  @pytest.mark.behavioral   - Behavioral validation tests
  @pytest.mark.unit         - Unit component tests
  @pytest.mark.integration  - Integration tests
  @pytest.mark.uat          - User acceptance tests
  @pytest.mark.journey      - Complete journey workflows
  @pytest.mark.performance  - Performance benchmarks
  @pytest.mark.story_5_7    - Story 5-7 specific tests
  @pytest.mark.cli          - CLI-related tests
  @pytest.mark.incremental  - Incremental processing tests

Run selective tests:
  pytest -m story_5_7           # All Story 5-7 tests
  pytest -m "story_5_7 and unit"  # Only unit tests for Story 5-7
  pytest tests/behavioral/epic_5/  # Only behavioral tests
  pytest tests/performance/  # Only performance tests


FIXTURE COMPOSITION
===================

Epic 5 Fixtures (in conftest.py):
  incremental_state_file
    ├── Empty initial state
    ├── Path: .data-extract-session/incremental-state.json
    └── Schema: v1.0 with all required fields

  processed_corpus_with_state
    ├── Source: 3 previously processed PDFs
    ├── Output: 3 corresponding JSON files
    ├── State: Full entry for each file
    └── Use case: Baseline incremental processing

  orphan_corpus
    ├── Source: 2 existing files
    ├── State: 5 file entries (3 deleted)
    └── Use case: Orphan/cleanup detection

  mixed_corpus
    ├── Unchanged: 2 files with matching hashes
    ├── Modified: 2 files with changed content
    ├── New: 2 files not in state
    └── Use case: Complete change detection validation


IMPLEMENTATION IMPORT PATHS
============================

From Story 5-7 tests, implementation should provide:

  from data_extract.cli.batch import (
      FileHasher,              # SHA256 hashing
      StateFile,              # Persistence
      ChangeDetector,         # Change detection logic
      GlobPatternExpander,    # Pattern matching
      IncrementalProcessor,   # Main orchestrator
  )

  from data_extract.cli.session import (
      SessionCorruptedError,  # Corruption detection
  )
