2026-02-14
- Fixed venv command availability in `.github/workflows/performance.yml` and `.github/workflows/security.yml` by seeding uv environments and exporting `.venv/bin` into `$GITHUB_PATH`, preventing `pytest`/`structlog` import-not-found failures in later steps.
- Fixed CI virtualenv persistence in `.github/workflows/test.yml` by exporting `.venv/bin` to `$GITHUB_PATH`, ensuring subsequent steps run with installed dependencies (`numpy`, `pytest`, etc.).
- Corrected security workflow step-id condition wiring in `.github/workflows/security.yml` (`secrets_scan` / `deps_scan`) so the final fail gate triggers only on actual scanner failures.
- Hardened `.github/workflows/uat.yaml` setup by seeding the uv venv, exporting venv binaries to `$GITHUB_PATH`, making `tmux-cli` installation best-effort, and guarding missing `uat-results.txt` in failure reporting.
- Fixed `.gitignore` scope for runtime artifacts by anchoring `/output/` to repo root, then added the previously ignored `src/data_extract/output/` package and `tests/unit/data_extract/output/` test suite to version control.
- Stabilized GitHub Actions Python jobs that install spaCy models by switching `uv venv` to `uv venv --seed` in test workflows so `python -m spacy download ...` can invoke `pip`.
- Updated performance workflow setup to install the spaCy model via `python -m spacy download en_core_web_md` and replaced inline expression args with shell gating for `workflow_dispatch` verbose mode.
- Reworked security workflow GitLeaks installation to resolve and download the current `linux_x64` release asset from the GitHub Releases API instead of the deprecated static `latest/download` tarball path.

2026-02-13
- Implemented queue high-watermark throttling with explicit `Retry-After` hints and detailed overload counters surfaced in `GET /api/v1/health?detailed=true`.
- Added operation-scoped SQLite lock retry telemetry and write-serialization support in `with_sqlite_lock_retry`, including per-operation retry/failure breakdowns.
- Added startup terminal reconciliation for `result_payload` and `result.json`, including deterministic repair/failure events and reconciliation snapshot metrics.
- Hardened jobs API queue-capacity responses to include retry guidance while preserving existing status-code contract (`503`).
- Added auth session endpoints (`POST/GET/DELETE /api/v1/auth/session`) using short-lived signed HttpOnly session cookies, while retaining `x-api-key` compatibility in middleware.
- Updated UI auth flow to session login/status/logout behavior and removed persistent API-key storage from browser local storage.
- Hardened OCR dependency downloader with retry/backoff controls (`--max-retries`, `--backoff-ms`), pinned Poppler version selection (`--poppler-version`), and version-aligned checksum validation.
- Added/updated unit coverage for health/queue/reconciliation behavior, auth middleware/session flow, OpenAPI contract paths, and OCR downloader retry/version logic.
- Added operational artifacts and ADR documentation for baseline harness and scaling thresholds: `docs/artifacts/wave-0-baseline.md`, `docs/architecture/adr-013-runtime-scaling-thresholds.md`, and `docs/artifacts/wave-5-operational-readiness.md`.

2026-02-10
- Refactored GUI New Run and Job Detail lifecycle UX with explicit source-mode selection, inline validation, action-first layout, and lifecycle timeline.
- Added stable UI test hooks and expanded lifecycle e2e assertions for source-mode clarity, validation, next-action guidance, and timeline presence.
- Introduced tokenized and reusable UI style primitives with focus-visible accessibility and responsive hardening while preserving existing shared panel/status/table patterns.
- Updated user/runtime/quickstart docs to describe the new UX behavior and runtime hygiene expectations.
- Added `.ui-home/` git ignore coverage and untracked `.ui-home/app.db` from the repository index.
- Updated installation validation runtime home defaults to avoid repo-tracked UI runtime state when `DATA_EXTRACT_UI_HOME` is unset.
- Verified Python-side gates and contract tests still pass; UI gate remains environment-blocked due unavailable npm registry and Playwright assets in this workspace.
- Serialized retry lifecycle persistence so queued state/event commit before retry worker enqueue, eliminating retry-path write races in SQLite.
- Removed temporary lifecycle e2e retry mitigations (`ui` test loop + Playwright CLI retries) and added router regression coverage to the refactor tests gate.

2026-02-12
- Fixed queue-capacity rejection semantics for process jobs so unaccepted submissions are discarded (DB + artifacts) instead of being persisted as terminal failures, preventing idempotency poisoning on later retries.
- Preserved prior job result metadata when retry enqueue is rejected by queue capacity by rolling back transient queued state/events in the jobs router.
- Refactored startup recovery into a two-phase flow (DB staging/commit then queue submission) to prevent duplicate in-memory submissions when SQLite lock retries re-execute recovery logic.
- Added and updated targeted regression tests for queue-full idempotency behavior, retry rollback/payload preservation, and recovery de-duplication under transient DB-lock contention.
- Re-ran regression validation in project venv: API/runtime suites, full unit suite, integration/performance semantic suites, and lint/format gates for modified files.
- Hardened local UI/API runtime resilience: startup recovery for queued/running jobs, SQLite WAL/busy-timeout tuning, configurable in-process worker concurrency, and richer health/readiness telemetry.
- Added security and deployment safeguards: API-key middleware support, remote host guardrails in `data-extract ui`, and centralized runtime dependency/readiness checks (including spaCy model validation).
- Reduced API/UI lock pressure with jobs/detail pagination plus client-side database-lock retries and adaptive polling behavior.
- Expanded API/runtime test coverage for auth middleware, health payload detail, queue worker behavior, startup job recovery, and jobs pagination.
- Applied repository-wide lint/import normalization changes and included all currently modified workspace files/artifacts in this commit scope.
- Completed strict stabilization pass: fixed CLI/service import-cycle boundaries, force-mode session cleanup, retry UX/behavior regressions, JSON/TXT output edge cases, and script compatibility mismatches.
- Eliminated strict typing blocker by resolving `mypy --strict` errors across CLI/API/semantic/output/service modules (97 -> 0) without relaxing gate settings.
- Re-ran full validation matrix to green: `ruff check src tests scripts`, `./.venv/bin/mypy src/data_extract/ --strict`, `./.venv/bin/pytest -q`, `npm run build --prefix ui`, and `npm run e2e:gui --prefix ui`.
- Completed public-readiness hardening for the repository: normalized package/license metadata, added MIT `LICENSE`, and aligned README licensing text with open-source distribution.
- Removed tracked local-only assistant runtime config (`.claude/settings.local.json`), hardened `.gitignore` for local state (`.codex/`, local `.claude` settings), and sanitized absolute machine paths across project docs and sample artifacts.
- Replaced public-risk fixture strategy by removing tracked third-party framework documents from `tests/fixtures/real_world_files/`, adding local-only corpus guidance, and deleting derived COBIT output artifacts.
- Fixed root cause in `scripts/create_performance_batch.py` by constraining PDF source selection to curated synthetic fixtures, regenerated `tests/performance/batch_100_files` with the same 100-file contract, and updated performance fixture documentation/baselines accordingly.
- Fixed residual pipeline/output regressions: added advanced->legacy empty-chunk fallback, restored deterministic TXT per-chunk 1-indexed filename sequencing, and corrected status JSON rendering for machine parsing.
- Improved quality-metrics runtime stability by making report generation/log formatting conditional, eliminating non-deterministic performance-scaling test failures under full-suite execution.
- Completed final verification loop to green with current tree: `ruff check src tests scripts`, `./.venv/bin/mypy src/data_extract/ --strict`, and `./.venv/bin/pytest -q` (`2728 passed, 264 skipped, 6 xfailed`).
- Added governance evaluation contract models and processing hooks (API form parsing, run-config resolution, job orchestration persistence, and governance policy/evaluator modules) with baseline policy definitions and unit coverage.
- Fixed evaluation fail-on-bad behavior to set both non-zero exit code and failed job status, so API persistence/retry semantics align with governance verdict outcomes.
- Reworked governance policy loading to prefer packaged resources with development fallback paths, eliminating source-tree path assumptions in installed environments.
- Completed regression validation for current workspace state: `PYTHONPATH=src .venv/bin/ruff check src tests` and `PYTHONPATH=src .venv/bin/pytest` (`2736 passed, 264 skipped, 6 xfailed`).
